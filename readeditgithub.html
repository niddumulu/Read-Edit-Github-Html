<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read & Edit GitHub HTML</title>
<style>
  body { font-family: Arial, sans-serif; background:#f7f7f7; margin:0; padding:20px; }
  h1 { text-align:center; color:#2c3e50; }
  .container { max-width:900px; margin:auto; background:white; padding:20px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); }
  label { font-weight:bold; display:block; margin-top:10px; }
  input, select, textarea { width:100%; padding:10px; margin-top:5px; border:1px solid #ccc; border-radius:5px; }
  button { margin-top:10px; padding:10px 20px; border:none; background:#2980b9; color:white; border-radius:5px; cursor:pointer; }
  button:hover { background:#3498db; }
  textarea { min-height:180px; resize:vertical; }
  .notification { margin-top:15px; padding:10px; color:white; border-radius:5px; display:none; }
  .success { background:#2ecc71; }
  .error { background:#e74c3c; }
</style>
</head>
<body>
<h1>Read & Edit GitHub HTML</h1>

<div class="container">
  <label>GitHub Token (Private, tidak disimpan):</label>
  <input type="password" id="tokenInput" placeholder="Masukkan Personal Access Token">

  <label>Owner (username GitHub):</label>
  <input type="text" id="owner" value="niddumulu">

  <label>Repository:</label>
  <input type="text" id="repo" value="handphone">

  <label>Branch:</label>
  <input type="text" id="branch" value="main">

  <hr>
  <label>Pilih File:</label>
  <select id="fileList" onchange="loadFile()">
    <option value="">-- Pilih file --</option>
  </select>

  <label>Isi File:</label>
  <textarea id="fileContent" placeholder="Isi file akan muncul di sini..."></textarea>

  <button onclick="updateFile()">üíæ Update File</button>
  <button onclick="createFile()">‚ûï Buat File Baru</button>
  <button onclick="deleteFile()">üóëÔ∏è Hapus File</button>

  <div id="notification" class="notification"></div>
</div>

<script>
async function loadFileList() {
  const token = document.getElementById("tokenInput").value.trim();
  const owner = document.getElementById("owner").value.trim();
  const repo = document.getElementById("repo").value.trim();
  const branch = document.getElementById("branch").value.trim();
  if (!token) return showNotification("Masukkan token terlebih dahulu!", "error");

  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents?ref=${branch}`, {
    headers: { Authorization: `token ${token}` }
  });
  const data = await res.json();
  const fileList = document.getElementById("fileList");
  fileList.innerHTML = `<option value="">-- Pilih file --</option>`;
  data.forEach(item => {
    if (item.type === "file") {
      const opt = document.createElement("option");
      opt.value = item.path;
      opt.textContent = item.name;
      fileList.appendChild(opt);
    }
  });
}

async function loadFile() {
  const token = document.getElementById("tokenInput").value.trim();
  const owner = document.getElementById("owner").value.trim();
  const repo = document.getElementById("repo").value.trim();
  const branch = document.getElementById("branch").value.trim();
  const filePath = document.getElementById("fileList").value;
  if (!filePath) return;
  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}?ref=${branch}`, {
    headers: { Authorization: `token ${token}` }
  });
  const data = await res.json();
  document.getElementById("fileContent").value = atob(data.content);
}

async function updateFile() {
  const token = document.getElementById("tokenInput").value.trim();
  const owner = document.getElementById("owner").value.trim();
  const repo = document.getElementById("repo").value.trim();
  const branch = document.getElementById("branch").value.trim();
  const filePath = document.getElementById("fileList").value;
  const content = document.getElementById("fileContent").value;
  if (!filePath || !content) return showNotification("Pilih file dan isi sebelum update!", "error");

  const getFile = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}?ref=${branch}`, {
    headers: { Authorization: `token ${token}` }
  });
  const fileData = await getFile.json();
  const sha = fileData.sha;
  const encoded = btoa(content);

  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`, {
    method: "PUT",
    headers: { Authorization: `token ${token}`, "Content-Type": "application/json" },
    body: JSON.stringify({ message: "Update file", content: encoded, sha, branch })
  });
  const data = await res.json();
  if (data.content) showNotification("‚úÖ File berhasil diperbarui!", "success");
  else showNotification("‚ùå Gagal memperbarui file!", "error");
}

async function createFile() {
  const token = document.getElementById("tokenInput").value.trim();
  const owner = document.getElementById("owner").value.trim();
  const repo = document.getElementById("repo").value.trim();
  const branch = document.getElementById("branch").value.trim();
  const newFile = prompt("Masukkan nama file baru (contoh: index.html):");
  if (!newFile) return;
  const content = btoa(document.getElementById("fileContent").value || "");
  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${newFile}`, {
    method: "PUT",
    headers: { Authorization: `token ${token}`, "Content-Type": "application/json" },
    body: JSON.stringify({ message: "Buat file baru", content, branch })
  });
  const data = await res.json();
  if (data.content) {
    showNotification("‚úÖ File baru dibuat!", "success");
    loadFileList();
  } else showNotification("‚ùå Gagal membuat file!", "error");
}

async function deleteFile() {
  const token = document.getElementById("tokenInput").value.trim();
  const owner = document.getElementById("owner").value.trim();
  const repo = document.getElementById("repo").value.trim();
  const branch = document.getElementById("branch").value.trim();
  const filePath = document.getElementById("fileList").value;
  if (!filePath) return;
  if (!confirm(`Hapus file "${filePath}"?`)) return;

  const getFile = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}?ref=${branch}`, {
    headers: { Authorization: `token ${token}` }
  });
  const fileData = await getFile.json();
  const sha = fileData.sha;

  const res = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`, {
    method: "DELETE",
    headers: { Authorization: `token ${token}`, "Content-Type": "application/json" },
    body: JSON.stringify({ message: "Hapus file", sha, branch })
  });
  const data = await res.json();
  if (data.commit) {
    showNotification("‚úÖ File dihapus!", "success");
    loadFileList();
  } else showNotification("‚ùå Gagal menghapus file!", "error");
}

function showNotification(msg, type) {
  const n = document.getElementById("notification");
  n.textContent = msg;
  n.className = `notification ${type}`;
  n.style.display = "block";
  setTimeout(() => n.style.display = "none", 4000);
}

document.getElementById("tokenInput").addEventListener("change", loadFileList);
</script>
</body>
</html>
